<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Standoff Ultimate Simulator</title>
    <style>
        :root {
            --bg: #0b0e14; --panel: #151921; --accent: #ff9d00;
            --common: #b0c3d9; --rare: #4b69ff; --epic: #8847ff; --legendary: #d32ce6; --arcane: #eb4b4b;
            --donate: #2ea44f;
        }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        /* Меню */
        .nav { display: flex; background: var(--panel); height: 60px; border-bottom: 2px solid #232936; }
        .nav-btn { flex: 1; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 11px; font-weight: 900; text-transform: uppercase; opacity: 0.5; transition: 0.3s; }
        .nav-btn.active { opacity: 1; color: var(--accent); border-bottom: 3px solid var(--accent); }

        .content { height: calc(100vh - 120px); overflow-y: auto; padding: 15px; box-sizing: border-box; }
        
        /* Сетка предметов */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px; }
        .card { background: #1c222d; border-radius: 10px; padding: 12px; text-align: center; border-bottom: 4px solid #333; position: relative; }
        .card img { width: 100%; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5)); }
        .card-name { font-size: 11px; margin: 8px 0; font-weight: bold; height: 30px; }
        
        /* Кнопки */
        .btn { width: 100%; border: none; padding: 12px; border-radius: 6px; font-weight: 900; cursor: pointer; text-transform: uppercase; font-size: 10px; transition: 0.2s; }
        .btn:active { transform: scale(0.95); }
        .btn-buy { background: var(--accent); color: #000; }
        .btn-sell { background: #2d333e; color: #fff; }
        .btn-donate { background: var(--donate); color: #fff; font-size: 12px; }

        /* Рынок и Кланы */
        .list-item { display: flex; align-items: center; background: #1c222d; padding: 12px; margin-bottom: 10px; border-radius: 8px; border-left: 5px solid var(--accent); }
        .list-item img { width: 60px; margin-right: 15px; }
        .clan-ui { background: var(--panel); padding: 25px; border-radius: 15px; text-align: center; border: 1px solid #232936; }
        
        /* Футер */
        .footer { height: 60px; background: var(--panel); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; border-top: 2px solid #232936; }
        .balance { color: var(--accent); font-weight: 900; font-size: 18px; }

        /* Донат и Промо */
        .input-box { width: 100%; padding: 12px; background: #0b0e14; border: 1px solid #232936; color: #fff; border-radius: 6px; margin-bottom: 10px; text-align: center; box-sizing: border-box; }
    </style>
</head>
<body>

    <div class="nav">
        <div class="nav-btn active" onclick="tab('shop', this)">Кейсы</div>
        <div class="nav-btn" onclick="tab('market', this)">Рынок</div>
        <div class="nav-btn" onclick="tab('inv', this)">Инвентарь</div>
        <div class="nav-btn" onclick="tab('clans', this)">Кланы</div>
        <div class="nav-btn" onclick="tab('donate', this)" style="color: var(--donate);">Донат</div>
    </div>

    <div class="content">
        <div id="tab-shop">
            <div class="grid">
                <div class="card" style="border-color: var(--accent);">
                    <img src="https://i.ibb.co/v4mYFvY/case-red.png">
                    <div class="card-name">8 YEARS GIFT CASE</div>
                    <button class="btn btn-buy" onclick="openCase()">ОТКРЫТЬ (100 G)</button>
                </div>
            </div>
        </div>

        <div id="tab-market" style="display:none;">
            <div id="market-list"></div>
        </div>

        <div id="tab-inv" style="display:none;">
            <div class="grid" id="inv-grid"></div>
        </div>

        <div id="tab-clans" style="display:none;">
            <div id="no-clan">
                <div class="clan-ui">
                    <h3>НОВЫЙ КЛАН</h3>
                    <input type="text" id="clan-tag-input" class="input-box" placeholder="ТЕГ (4 БУКВЫ)" maxlength="4">
                    <button class="btn btn-buy" onclick="createClan()">СОЗДАТЬ ЗА 500 G</button>
                </div>
            </div>
            <div id="my-clan" style="display:none;">
                <div class="clan-ui">
                    <div id="display-tag" style="font-size: 40px; font-weight: 900; color: var(--accent);"></div>
                    <p>Клановый опыт: <span id="clan-exp">0</span> XP</p>
                    <button class="btn" style="background: #ff4444;" onclick="leaveClan()">ПОКИНУТЬ</button>
                </div>
            </div>
        </div>

        <div id="tab-donate" style="display:none;">
            <div class="clan-ui" style="margin-bottom: 20px;">
                <h4 style="color:var(--donate)">ПРОМОКОДЫ</h4>
                <input type="text" id="promo-input" class="input-box" placeholder="ВВЕДИТЕ КОД">
                <button class="btn btn-buy" onclick="activatePromo()">АКТИВИРОВАТЬ</button>
            </div>
            <div class="clan-ui">
                <h4 style="color:var(--donate)">ПОПОЛНЕНИЕ (DonationAlerts)</h4>
                <p style="font-size: 11px;">Твой ID: <b id="u-id"></b></p>
<button class="btn btn-donate" onclick="window.location.href='https://dalink.to/vibebotdev'">ПЕРЕЙТИ К ОПЛАТЕ</button>

                <p style="font-size: 9px; opacity: 0.5; margin-top: 10px;">* Укажите ID в сообщении доната. Администратор выдаст промокод.</p>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="balance"><span id="gold">0</span> G</div>
        <div id="user-clan" style="opacity: 0.5; font-size: 12px;">[НЕТ КЛАНА]</div>
    </div>

    <script>
        // Конфигурация
        const SKINS = [
            { name: "Butterfly 'Legacy'", rare: "arcane", file: "бабочка.webp", price: 12500 },
            { name: "AKR 'Tiger'", rare: "rare", file: "тигер.webp", price: 45 },
            { name: "M4 'Lizard'", rare: "epic", file: "лизард.webp", price: 420 },
            { name: "G22 'Starfall'", rare: "epic", file: "г22.webp", price: 130 }
        ];

        const PROMOS = {
            "START": 500,
            "ARTEMKA": 5000,
            "FREE-GOLD": 1000,
            "FRIENDS": 2500
        };

        let data = JSON.parse(localStorage.getItem('so2_data')) || {
            uid: Math.floor(100000 + Math.random() * 899999),
            gold: 1000,
            inv: [],
            market: [],
            clan: null,
            usedPromos: []
        };

        function save() {
            localStorage.setItem('so2_data', JSON.stringify(data));
            render();
        }

        function tab(name, btn) {
            document.querySelectorAll('.content > div').forEach(d => d.style.display = 'none');
            document.getElementById('tab-' + name).style.display = 'block';
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            render();
        }

        function render() {
            document.getElementById('gold').innerText = data.gold.toLocaleString();
            document.getElementById('u-id').innerText = data.uid;
            document.getElementById('user-clan').innerText = data.clan ? `[${data.clan.tag}]` : '[НЕТ КЛАНА]';

            // Инвентарь
            const invGrid = document.getElementById('inv-grid');
            invGrid.innerHTML = '';
            data.inv.forEach(s => {
                invGrid.innerHTML += `
                    <div class="card" style="border-color: var(--${s.rare})">
                        <img src="${s.file}">
                        <div class="card-name">${s.name}</div>
                        <button class="btn btn-sell" onclick="toMarket(${s.id})">ПРОДАТЬ</button>
                    </div>`;
            });

            // Рынок
            const mList = document.getElementById('market-list');
            mList.innerHTML = data.market.length ? '' : '<p style="text-align:center;opacity:0.5">На рынке нет товаров</p>';
            data.market.forEach((s, idx) => {
                mList.innerHTML += `
                    <div class="list-item" style="border-left-color: var(--${s.rare})">
                        <img src="${s.file}">
                        <div style="flex-grow:1">
                            <div style="font-weight:bold; font-size:13px">${s.name}</div>
                            <div style="color:var(--${s.rare}); font-size:10px; text-transform:uppercase">${s.rare}</div>
                        </div>
                        <div style="text-align:right">
                            <div style="color:var(--accent); font-weight:900">${s.mPrice} G</div>
                            <button class="btn btn-buy" style="padding:5px 10px" onclick="buy(${idx})">КУПИТЬ</button>
                        </div>
                    </div>`;
            });

            // Кланы
            if(data.clan) {
                document.getElementById('no-clan').style.display = 'none';
                document.getElementById('my-clan').style.display = 'block';
                document.getElementById('display-tag').innerText = `[${data.clan.tag}]`;
                document.getElementById('clan-exp').innerText = data.clan.exp;
            }
        }

        // Функции игры
        function openCase() {
            if(data.gold < 100) return alert("Недостаточно голды!");
            data.gold -= 100;
            const drop = SKINS[Math.floor(Math.random() * SKINS.length)];
            data.inv.push({...drop, id: Date.now()});
            if(data.clan) data.clan.exp += 10;
            save();
            alert(`ВЫПАЛО: ${drop.name}`);
        }

        function toMarket(id) {
            const idx = data.inv.findIndex(i => i.id === id);
            const price = prompt("Введите цену продажи:", data.inv[idx].price);
            if(price > 0) {
                const item = data.inv.splice(idx, 1)[0];
                data.market.push({...item, mPrice: parseInt(price)});
                save();
            }
        }

        function buy(idx) {
            if(data.gold >= data.market[idx].mPrice) {
                data.gold -= data.market[idx].mPrice;
                data.inv.push(data.market.splice(idx, 1)[0]);
                save();
            }
        }

        function createClan() {
            const tag = document.getElementById('clan-tag-input').value.toUpperCase();
            if(tag.length < 2 || data.gold < 500) return alert("Ошибка создания!");
            data.gold -= 500;
            data.clan = { tag: tag, exp: 0 };
            save();
        }

        function leaveClan() {
            if(confirm("Выйти?")) { data.clan = null; save(); location.reload(); }
        }

        function activatePromo() {
            const code = document.getElementById('promo-input').value.toUpperCase();
            if(data.usedPromos.includes(code)) return alert("Уже использован!");
            if(PROMOS[code]) {
                data.gold += PROMOS[code];
                data.usedPromos.push(code);
                alert(`✅ Активировано! +${PROMOS[code]} G`);
                save();
            } else { alert("Код не найден"); }
            document.getElementById('promo-input').value = "";
        }

        function doDonate(link) {
            alert(`ОБЯЗАТЕЛЬНО укажите ваш ID в донате: ${data.uid}`);
            window.location.href = link;
        }

        // Автовыкуп (жизнь рынка)
        setInterval(() => {
            if(data.market.length > 0 && Math.random() > 0.8) {
                const idx = Math.floor(Math.random() * data.market.length);
                const item = data.market.splice(idx, 1)[0];
                data.gold += item.mPrice * 0.85; // 15% комиссия
                save();
            }
        }, 30000);

        save(); // Первая отрисовка
    </script>
</body>
</html>
